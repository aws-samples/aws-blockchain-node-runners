"use strict";(self.webpackChunkaws_blockchain_node_runners=self.webpackChunkaws_blockchain_node_runners||[]).push([[929],{6978:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>h});const o=JSON.parse('{"id":"intro/setup","title":"setup","description":"","source":"@site/docs/intro/setup.md","sourceDirName":"intro","slug":"/setup-cloud9.md","permalink":"/aws-blockchain-node-runners/docs/setup-cloud9.md","draft":false,"unlisted":false,"editUrl":"https://github.com/aws-samples/aws-blockchain-node-runners/website/docs/intro/setup.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Setup","slug":"/setup-cloud9.md"},"sidebar":"sidebar","previous":{"title":"Introduction","permalink":"/aws-blockchain-node-runners/docs/intro/"},"next":{"title":"About blueprints","permalink":"/aws-blockchain-node-runners/docs/Blueprints/intro"}}');var t=s(4848),l=s(8453);function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"aws-cloudshell",children:"AWS CloudShell"})}),"\n",(0,t.jsx)(n.p,{children:"To begin, ensure you login to your AWS account with permissions to create and modify resources in IAM, EC2, EBS, VPC, S3, KMS, and Secrets Manager."}),"\n",(0,t.jsxs)(n.p,{children:["From the AWS Management Console, open the ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/cloudshell/latest/userguide/welcome.html",children:"AWS CloudShell"}),", a web-based shell environment. If unfamiliar, review the ",(0,t.jsx)(n.a,{href:"https://youtu.be/fz4rbjRaiQM",children:"2-minute YouTube video"})," for an overview and check out ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/cloudshell/latest/userguide/creating-vpc-environment.html",children:"CloudShell with VPC environment"})," that we'll use to test nodes API from internal IP address space."]}),"\n",(0,t.jsx)(n.p,{children:"Once ready, you can execute the commands to deploy and test blueprints in the CloudShell."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h1,{id:"aws-cloud-9-is-no-longer-used-the-instructions-below-will-be-removed-soon-use-aws-cloudshell-instead",children:"AWS Cloud 9 IS NO LONGER USED (the instructions below will be removed soon, use AWS CloudShell instead)"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h1,{id:"aws-cloud9-setup",children:"AWS Cloud9 Setup"}),"\n",(0,t.jsx)(n.p,{children:"Most steps in this repository will need to be performed from a Linux command prompt. An especially convenient way of doing this is to use AWS Cloud9, a cloud-based Integrated Development Environment (IDE). Cloud9 allows you to edit source files and execute commands from an easy-to-use web interface. It comes pre-configured with many of the tools needed for software development, and because it runs in the AWS Cloud, it can be an especially easy way to access other cloud services. One other handy feature is that your Cloud9 instances automatically stop running after a configurable period of inactivity, which helps reduce costs."}),"\n",(0,t.jsx)(n.h2,{id:"create-a-cloud9-environment",children:"Create a Cloud9 environment"}),"\n",(0,t.jsxs)(n.p,{children:["Navigate to the AWS Cloud9 service in your Management Console, then select Create environment. Choose any name you want. For environment type, select ",(0,t.jsx)(n.strong,{children:"New EC2 instance"}),". For instance type, select ",(0,t.jsx)(n.strong,{children:"Additional instance type"})," and choose ",(0,t.jsx)(n.strong,{children:"t3.medium"}),". For platform, select ",(0,t.jsx)(n.strong,{children:"Amazon Linux 2023"}),". Leave all other settings at their default, then select ",(0,t.jsx)(n.strong,{children:"Create"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"create-iam-role-for-cloud9-instance-with-aws-cli",children:"Create IAM Role for Cloud9 instance with AWS CLI"}),"\n",(0,t.jsxs)(n.p,{children:["If you have AWS Comand Line Interface ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html",children:"installed and configured"})," on your local machine, perform the following steps in your ",(0,t.jsx)(n.strong,{children:"local machine"}),". Alternatively, in some regions, you can use ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/cloudshell/latest/userguide/welcome.html",children:"AWS CloudShell"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Create an instance profile called ",(0,t.jsx)(n.strong,{children:"Cloud9-Developer-Access"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create role policy definition file"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'cat > ec2-trust-policy.json <<EOF\n{\n"Version": "2012-10-17",\n    "Statement": [\n        {\n        "Effect": "Allow",\n        "Principal": {\n        "Service": "ec2.amazonaws.com"\n        },\n        "Action": "sts:AssumeRole"\n        }\n    ]\n}\nEOF\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:'Create new IAM role called "Cloud9-Developer-Access" and assign the new role policy'}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws iam create-role \\\n--role-name Cloud9-Developer-Access \\\n--assume-role-policy-document file://ec2-trust-policy.json\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"Attach AWS Managed policy with AdministratorAccess to the new role"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws iam attach-role-policy \\\n    --role-name Cloud9-Developer-Access \\\n    --policy-arn arn:aws:iam::aws:policy/AdministratorAccess\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Create EC2 instance profile"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws iam create-instance-profile --instance-profile-name Cloud9-Developer-Access\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"5",children:["\n",(0,t.jsx)(n.li,{children:"Add the new role to the instance profile"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws iam add-role-to-instance-profile \\\n    --instance-profile-name Cloud9-Developer-Access \\\n    --role-name Cloud9-Developer-Access\n"})}),"\n",(0,t.jsx)(n.h2,{id:"modify-cloud9-iam-role",children:"Modify Cloud9 IAM role"}),"\n",(0,t.jsxs)(n.p,{children:["In order to perform some operations for this workshop, it is necessary to assign an IAM machine role to your Cloud9 environment. In order for this role to take effect, it is necessary to disable Cloud9's normal management of your credentials. To do this, click the settings gear icon in the top-right corner of your Cloud9 environment. Scroll down and open the section for ",(0,t.jsx)(n.strong,{children:"AWS Settings"}),". Disable ",(0,t.jsx)(n.strong,{children:"AWS managed temporary credentials"}),". Close the preferences pane."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Cloud9 Console",src:s(802).A+"",width:"840",height:"472"})}),"\n",(0,t.jsxs)(n.p,{children:["Now attach the machine role you created previously to your Cloud9 environment. To do this, go to the EC2 service in the AWS Management Console and select Instances on the lefthand sidebar. Check the box next to your Cloud9 instance, then select ",(0,t.jsx)(n.strong,{children:"Actions > Security > Modify IAM role"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Change EC2 IAM Role 1",src:s(867).A+"",width:"878",height:"299"})}),"\n",(0,t.jsxs)(n.p,{children:["Select the IAM role you created previously and then ",(0,t.jsx)(n.strong,{children:"Update IAM role"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Change EC2 IAM Role 1",src:s(5846).A+"",width:"670",height:"418"})}),"\n",(0,t.jsx)(n.h2,{id:"bootstrapping-cdk",children:"Bootstrapping CDK"}),"\n",(0,t.jsxs)(n.p,{children:["Perform the following steps in your ",(0,t.jsx)(n.strong,{children:"Cloud9 instance"})]}),"\n",(0,t.jsxs)(n.p,{children:["After arranging your environment windows, you'll want to install and update some utilities in your environment and set your default AWS region. If you are working in another region, substitute it for ",(0,t.jsx)(n.strong,{children:"us-east-1"})," in the commands below:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo pip install awscli --upgrade\nsudo yum install -y jq\naws configure set default.region us-east-1\n"})}),"\n",(0,t.jsx)(n.p,{children:"Install NodeJS v18 and set as the default version"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nvm install 18\nnvm use 18\nnvm alias default 18\n"})}),"\n",(0,t.jsx)(n.p,{children:"The AWS CDK includes the CDK Toolkit (also called the CLI), a command line tool for working with your AWS CDK apps and stacks. Install the CDK toolkit"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install -g aws-cdk\ncdk --version\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Install ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html",children:"Session Manager plugin for AWS CLI"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl "https://s3.amazonaws.com/session-manager-downloads/plugin/latest/linux_64bit/session-manager-plugin.rpm" -o "session-manager-plugin.rpm"\nsudo yum install -y session-manager-plugin.rpm\n\n'})}),"\n",(0,t.jsx)(n.p,{children:"Deploying stacks with the AWS CDK requires dedicated Amazon S3 buckets and other containers to be available to AWS CloudFormation during deployment. Creating these is called bootstrapping. To bootstrap, issue:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cdk bootstrap aws://<INSERT_YOUR_AWS_ACCOUNT_NUMBER>/<INSERT_YOUR_AWS_REGION>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"clearing-up-and-deleting-aws-cloud9",children:"Clearing up and deleting AWS Cloud9"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Delete Cloud9 instance"}),"\n",(0,t.jsxs)(n.p,{children:["Navigate to the AWS Cloud9 service in your Management Console, then select the environment you have created. On the top right, click ",(0,t.jsx)(n.strong,{children:"Delete"})," button and  follow the instructions."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Delete the instance profile and IAM role"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"aws iam delete-instance-profile --instance-profile-name Cloud9-Developer-Access\naws iam delete-role --role-name Cloud9-Developer-Access\n"})})]})}function r(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}const i={sidebar_position:1,sidebar_label:"Setup",slug:"/setup-cloud9.md"},c="",d={},h=[{value:"Create a Cloud9 environment",id:"create-a-cloud9-environment",level:2},{value:"Create IAM Role for Cloud9 instance with AWS CLI",id:"create-iam-role-for-cloud9-instance-with-aws-cli",level:2},{value:"Modify Cloud9 IAM role",id:"modify-cloud9-iam-role",level:2},{value:"Bootstrapping CDK",id:"bootstrapping-cdk",level:2},{value:"Clearing up and deleting AWS Cloud9",id:"clearing-up-and-deleting-aws-cloud9",level:2}];function u(e){const n={h1:"h1",header:"header",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:""})}),"\n","\n",(0,t.jsx)(r,{})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},867:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/change-iam-role-717f8b14f8bf97564ed34d68c7f31e64.png"},5846:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/change-instance-role-b16f4b820691e4f8cdc39687e8b799a1.png"},802:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/cloud9-iam-1-9adcfaaf31c6cfddcf785a54c014fbe4.png"},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var o=s(6540);const t={},l=o.createContext(t);function a(e){const n=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);